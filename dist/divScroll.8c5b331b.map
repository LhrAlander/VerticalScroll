{"version":3,"sources":["js\\polyfill.js","js\\divScroll.js"],"names":["$","document","querySelector","selector","applyStyle","el","styleMedia","i","style","ensureNumber","n","isNaN","lastTime","vendors","x","length","window","requestAnimationFrame","cancelAnimationFrame","callback","element","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout","CountScroll","options","targetVal","currentVal","size","duration","itemSize","width","height","wrapperEl","firstWrapper","secondWrapper","scrollOp","startTime","targetST","currentST","Object","defineProperty","set","error","console","_init_","prototype","parentEl","childNodes","forEach","log","node","removeChild","styleItems","display","createElement","overflow","getBoundingClientRect","item","innerHTML","appendChild","cloneNode","scrollTop","setTargetVal","val","startScroll","cb","animationFn","timeStamp","rAF","progress","delta"],"mappings":"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","file":"divScroll.8c5b331b.map","sourceRoot":"..","sourcesContent":["export const $ = selector => document.querySelector(selector)\r\nexport const applyStyle = (el, styleMedia) => {\r\n  for (let i in styleMedia) {\r\n    el.style[i] = styleMedia[i]\r\n  }\r\n}\r\nexport const ensureNumber = n => {\r\n  return (typeof n === 'number' && !isNaN(n));\r\n}\r\n// 确保存在 requestAnimationFrame 和 cancelAnimationFrame 存在\r\nlet lastTime = 0\r\nlet vendors = ['webkit', 'moz', 'ms', 'o']\r\nfor(let x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n  window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame']\r\n  window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame']\r\n}\r\nif (!window.requestAnimationFrame) {\r\n  window.requestAnimationFrame = function(callback, element) {\r\n    let currTime = new Date().getTime()\r\n    let timeToCall = Math.max(0, 16 - (currTime - lastTime))\r\n    let id = window.setTimeout(function() { callback(currTime + timeToCall) }, timeToCall)\r\n    lastTime = currTime + timeToCall\r\n    return id\r\n  }\r\n}\r\nif (!window.cancelAnimationFrame) {\r\n  window.cancelAnimationFrame = function(id) {\r\n    clearTimeout(id)\r\n  }\r\n}\r\n","import { $, applyStyle, ensureNumber } from './polyfill'\r\nfunction CountScroll (options) {\r\n  this.targetVal = null\r\n  // 初始化需要的参数\r\n  this.options = {\r\n    el: null,\r\n    currentVal: 1,\r\n    size: 10,\r\n    duration: 500\r\n  }\r\n  // 显示区域的大小存储\r\n  this.itemSize = {\r\n    width: 0,\r\n    height: 0\r\n  }\r\n  // 涉及到的 HTML Element\r\n  this.el = {\r\n    wrapperEl: null,\r\n    firstWrapper: null,\r\n    secondWrapper: null\r\n  }\r\n  // 滚动所需的一系列参数\r\n  this.scrollOp = {\r\n    startTime: null,\r\n    targetST: null,\r\n    currentST: null\r\n  }\r\n  // 报错信息提示\r\n  Object.defineProperty(this, 'error', {\r\n    set: function (error) {\r\n      console.error(error)\r\n    }\r\n  })\r\n  this._init_(options)\r\n}\r\n\r\n/**\r\n * 画出两个竖直排列的 div，同时将位置移至当前数值位置\r\n * @param{配置项} options\r\n */\r\nCountScroll.prototype._init_ = function (options) {\r\n  if (typeof options.el !== 'string') {\r\n    this.error = 'typeError: \\'el\\' is not a string'\r\n    return\r\n  }\r\n  let parentEl = $(options.el)\r\n  if (!parentEl) {\r\n    this.error = `el not founded: can not find a element by selector '${options.el}'`\r\n    return\r\n  }\r\n  parentEl.childNodes.forEach(node => {\r\n    console.log(node)\r\n    parentEl.removeChild(node)\r\n  })\r\n  let styleItems = {\r\n    display: 'flex',\r\n    'flex-direction': 'column',\r\n    'overflow': 'auto'\r\n  }\r\n  applyStyle(parentEl, styleItems)\r\n  this.options.el = parentEl\r\n  this.options.currentVal = options.currentVal >= 0 ? options.currentVal : this.options.currentVal\r\n  this.options.currentVal = options.size >= 0 ? options.currentVal : this.options.currentVal\r\n  this.options.duration = options.size >= 0 ? options.duration : this.options.duration\r\n  let wrapperEl = document.createElement('div')\r\n  let firstWrapper = document.createElement('div')\r\n  styleItems = {\r\n    width: '100%',\r\n    height: '100%',\r\n    overflow: 'hidden'\r\n  }\r\n  applyStyle(wrapperEl, styleItems)\r\n  // 单个框的宽高\r\n  this.itemSize = {\r\n    width: parentEl.getBoundingClientRect().width,\r\n    height: parentEl.getBoundingClientRect().height\r\n  }\r\n  styleItems = {\r\n    display: 'block',\r\n    width: '100%',\r\n    height: '100px',\r\n    'flex-shrink': '0'\r\n  }\r\n  for (let i = 0, length = this.options.size; i < length; i++) {\r\n    let item = document.createElement('div')\r\n    applyStyle(item, styleItems)\r\n    item.innerHTML = i\r\n    firstWrapper.appendChild(item)\r\n  }\r\n  let secondWrapper = firstWrapper.cloneNode(true)\r\n  wrapperEl.appendChild(firstWrapper)\r\n  wrapperEl.appendChild(secondWrapper)\r\n  parentEl.appendChild(wrapperEl)\r\n  this.el.wrapperEl = wrapperEl\r\n  this.el.firstWrapper = firstWrapper\r\n  this.el.secondWrapper = secondWrapper\r\n  wrapperEl.scrollTop = this.options.currentVal * this.itemSize.height\r\n}\r\n\r\n/**\r\n * 设置滚动结束点\r\n */\r\nCountScroll.prototype.setTargetVal = function (val) {\r\n  if (!ensureNumber(val)) {\r\n    this.error = 'typeError: target value is not a number'\r\n    return\r\n  }\r\n  this.targetVal = val\r\n  this.scrollOp.lastTime = null\r\n  this.scrollOp.startTime = null\r\n  this.scrollOp.targetST = (this.options.size + val) * this.itemSize.height\r\n  this.scrollOp.currentST = this.el.wrapperEl.scrollTop\r\n  return this\r\n}\r\n\r\n/**\r\n * 开始滚动\r\n */\r\nCountScroll.prototype.startScroll = function (cb) {\r\n  console.log(this)\r\n  if (!this.options.el) return\r\n  const animationFn = timeStamp => {\r\n    if (!this.scrollOp.startTime) this.scrollOp.startTime = timeStamp\r\n    if (this.el.wrapperEl.scrollTop >= this.scrollOp.targetST) {\r\n      this.el.wrapperEl.scrollTop = this.scrollOp.targetST - (this.options.size * this.itemSize.height)\r\n      cancelAnimationFrame(this.rAF)\r\n      if (cb && typeof cb === 'function') cb()\r\n    } else {\r\n      let progress = timeStamp - this.scrollOp.startTime\r\n      let delta = (this.scrollOp.targetST - this.scrollOp.currentST) * progress / this.options.duration\r\n      this.el.wrapperEl.scrollTop = delta + this.scrollOp.currentST\r\n      requestAnimationFrame(animationFn)\r\n    }\r\n  }\r\n  this.rAF = requestAnimationFrame(animationFn)\r\n}\r\n"]}